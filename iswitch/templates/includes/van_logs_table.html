<div class="table-filters"
    style="display: flex; gap: 1rem; align-items: flex-end; flex-wrap: wrap; padding: 1.5rem; background: #ffffff; border-bottom: 1px solid var(--border-color); border-radius: 8px 8px 0 0;">
    <div class="filter-group" style="flex: 1; min-width: 250px; max-width: 300px;">
        <label
            style="display: block; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; color: var(--text-secondary);">From
            Date & Time</label>
        <input type="datetime-local" name="from_date" class="form-control" value="{{ filters.from_date or '' }}"
            style="width: 100%; height: 42px; padding: 0 1rem;"
            hx-get="/api/method/iswitch.portal_api.get_merchant_van_logs" hx-trigger="change"
            hx-include="[name='to_date']" hx-target="#van-content">
    </div>

    <div class="filter-group" style="flex: 1; min-width: 250px; max-width: 300px;">
        <label
            style="display: block; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; color: var(--text-secondary);">To
            Date & Time</label>
        <input type="datetime-local" name="to_date" class="form-control" value="{{ filters.to_date or '' }}"
            style="width: 100%; height: 42px; padding: 0 1rem;"
            hx-get="/api/method/iswitch.portal_api.get_merchant_van_logs" hx-trigger="change"
            hx-include="[name='from_date']" hx-target="#van-content">
    </div>

    <div class="filter-group" style="margin-left: auto;">
        <button class="btn btn-secondary" onclick="exportVANLogs()" {% if not logs %}disabled{% endif %}
            style="display: inline-flex; align-items: center; gap: 0.5rem; height: 42px; padding: 0 1.25rem; font-weight: 500; white-space: nowrap;{% if not logs %} opacity: 0.5; cursor: not-allowed;{% endif %}">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="18" height="18">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
            Export to Excel
        </button>
    </div>
</div>

{% if logs %}
<table>
    <thead>
        <tr>
            <th>TXN ID</th>
            <th>Account Number</th>
            <th>UTR</th>
            <th>Amount</th>
            <th>Date</th>
        </tr>
    </thead>
    <tbody>
        {% for log in logs %}
        <tr>
            <td data-label="TXN ID">{{ log.name or '-' }}</td>
            <td data-label="Account Number">{{ log.account_number or '-' }}</td>
            <td data-label="UTR">{{ log.utr or '-' }}</td>
            <td data-label="Amount">â‚¹{{ "{:,.2f}".format(log.amount or 0) }}</td>
            <td data-label="Date">{{ frappe.utils.format_datetime(log.creation, "dd MMM yyyy, HH:mm") if log.creation else '-' }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if pagination %}
<div class="pagination">
    <div class="pagination-info">
        Showing {{ ((pagination.page - 1) * pagination.limit) + 1 }} to {{ [pagination.page * pagination.limit,
        pagination.total]|min }} of {{ pagination.total }} results
    </div>
    <div class="pagination-controls" style="align-items: center;">
        {% if pagination.page > 1 %}
        <button class="btn btn-secondary btn-sm"
            hx-get="/api/method/iswitch.portal_api.get_merchant_van_logs?page={{ pagination.page - 1 }}&limit={{ pagination.limit }}&from_date={{ filters.from_date or '' }}&to_date={{ filters.to_date or '' }}"
            hx-target="#van-content" hx-swap="innerHTML">
            Previous
        </button>
        {% endif %}
        <span style="padding: 0 1rem;">Page {{ pagination.page }} of {{ pagination.pages }}</span>
        {% if pagination.page < pagination.pages %} <button class="btn btn-secondary btn-sm"
            hx-get="/api/method/iswitch.portal_api.get_merchant_van_logs?page={{ pagination.page + 1 }}&limit={{ pagination.limit }}&from_date={{ filters.from_date or '' }}&to_date={{ filters.to_date or '' }}"
            hx-target="#van-content" hx-swap="innerHTML">
            Next
            </button>
            {% endif %}
    </div>
</div>
{% endif %}

{% else %}
<div class="empty-state">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="64" height="64">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
    </svg>
    <h3>No VAN logs found</h3>
    <p>No virtual account transactions yet</p>
</div>
{% endif %}