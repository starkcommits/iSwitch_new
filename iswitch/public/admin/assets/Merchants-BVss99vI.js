var X=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var H=(p,m)=>{var u={};for(var c in p)ue.call(p,c)&&m.indexOf(c)<0&&(u[c]=p[c]);if(p!=null&&X)for(var c of X(p))m.indexOf(c)<0&&pe.call(p,c)&&(u[c]=p[c]);return u};var E=(p,m,u)=>new Promise((c,w)=>{var S=o=>{try{b(u.next(o))}catch(h){w(h)}},v=o=>{try{b(u.throw(o))}catch(h){w(h)}},b=o=>o.done?c(o.value):Promise.resolve(o.value).then(S,v);b((u=u.apply(p,m)).next())});import{m as ce,p as R,w as r,r as M,q as fe,u as me,x as s,o as f,c as ge,g as d,y as J,b as t,a as g,n as L,e as _,f as ve,d as F,t as k,z as C,k as z,l as x,h as y,v as $,F as T,A as N,j as A}from"./index-Bw-JcXfn.js";import{D as be}from"./DataTable-DkLE46Ix.js";import{S as Z,n as xe,$ as _e,P as ye,c as I,X as he,I as ke,B as we,a as Ue}from"./utils-1gpEXdR4.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=ce("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W={__name:"Dialog",props:{open:{type:Boolean,default:void 0},defaultOpen:{type:Boolean,default:void 0},modal:{type:Boolean,default:void 0}},emits:["update:open"],setup(p,{emit:m}){const w=Z(p,m);return(S,v)=>(f(),R(s(xe),fe(me(s(w))),{default:r(()=>[M(S.$slots,"default")]),_:3},16))}},q={__name:"DialogContent",props:{forceMount:{type:Boolean,default:void 0},trapFocus:{type:Boolean,default:void 0},disableOutsidePointerEvents:{type:Boolean,default:void 0},asChild:{type:Boolean,default:void 0},as:{type:null,default:void 0},class:{type:String,default:void 0}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(p,{emit:m}){const u=p,c=m,w=ge(()=>{const o=u,{class:v}=o;return H(o,["class"])}),S=Z(w,c);return(v,b)=>(f(),R(s(ke),null,{default:r(()=>[d(s(_e),{class:"fixed inset-0 z-[9999] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),d(s(ye),J(s(S),{class:s(I)("fixed left-[50%] top-[50%] z-[9999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",u.class)}),{default:r(()=>[M(v.$slots,"default"),d(s(he),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:r(()=>[d(s(Se),{class:"h-4 w-4"}),b[0]||(b[0]=t("span",{class:"sr-only"},"Close",-1))]),_:1})]),_:3},16,["class"])]),_:3}))}},K={__name:"DialogHeader",props:{class:{type:String,default:""}},setup(p){const m=p;return(u,c)=>(f(),g("div",{class:L(s(I)("flex flex-col space-y-1.5 text-center sm:text-left",m.class))},[M(u.$slots,"default")],2))}},G={__name:"DialogTitle",props:{asChild:{type:Boolean,default:!1},as:{type:null,default:"h2"},class:{type:String,default:""}},setup(p){const m=p;return(u,c)=>(f(),R(s(we),J(m,{class:s(I)("text-lg font-semibold leading-none tracking-tight",m.class)}),{default:r(()=>[M(u.$slots,"default")]),_:3},16,["class"]))}},Q={__name:"DialogDescription",props:{asChild:{type:Boolean,default:!1},class:{type:String,default:""}},setup(p){const m=p;return(u,c)=>(f(),R(s(Ue),J(m,{class:s(I)("text-sm text-muted-foreground",m.class)}),{default:r(()=>[M(u.$slots,"default")]),_:3},16,["class"]))}},Y={__name:"DialogFooter",props:{class:{type:String,default:""}},setup(p){const m=p;return(u,c)=>(f(),g("div",{class:L(s(I)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",m.class))},[M(u.$slots,"default")],2))}},Ve={class:"p-6 max-w-7xl mx-auto space-y-6"},Ce={class:"rounded-xl border bg-card text-card-foreground shadow-sm overflow-hidden"},$e={key:0,class:"p-4 border-b bg-muted/40 flex items-center justify-between"},Be={class:"text-sm font-medium"},De={class:"flex gap-2"},Pe={class:"py-4"},Ee={key:0},Me={key:1},Fe=["value"],ze={class:"font-medium text-foreground"},Ae={key:0,class:"mt-4 space-y-6"},Ie={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Te=["value"],Ne={class:"rounded-md border max-h-[40vh] overflow-auto"},Re={class:"w-full caption-bottom text-sm"},je={class:"[&_tr:last-child]:border-0"},Oe={class:"p-2 align-middle font-medium"},Je=["onUpdate:modelValue"],Le=["value"],Xe={class:"p-2 align-middle"},He=["onUpdate:modelValue"],We={class:"p-2 align-middle"},qe=["onUpdate:modelValue"],Ke={class:"p-2 align-middle"},Ge=["onUpdate:modelValue"],Qe={class:"p-2 align-middle"},Ye=["onUpdate:modelValue"],Ze={class:"p-2 align-middle"},et={class:"flex gap-1 items-center"},tt=["onUpdate:modelValue"],at=["onUpdate:modelValue"],ot={class:"p-2 align-middle"},st=["onClick"],lt={key:0},nt={class:"mt-2"},rt={key:1,class:"mt-4 flex justify-end"},dt={class:"text-sm text-destructive bg-destructive/10 px-3 py-2 rounded border border-destructive/20"},ft={__name:"Merchants",setup(p){const m=[{key:"company_name",label:"Company",sortable:!0},{key:"company_email",label:"Email",sortable:!0},{key:"status",label:"Status",type:"badge",sortable:!0},{key:"integration",label:"Integration",sortable:!0},{key:"wallet_balance",label:"Wallet Balance",sortable:!0},{key:"actions",label:"Actions",sortable:!1}],u=_([]),c=_([]),w=_([]),S=_(!1),v=_(!1),b=_(!1),o=_(null),h=_(""),B=_([]),D=_(!1),P=_(""),V=_(""),j=()=>E(this,null,function*(){S.value=!0;try{const l=yield z("iswitch.admin_portal_api.get_merchants"),e=(l==null?void 0:l.message)||l;e&&e.merchants&&(u.value=e.merchants)}catch(l){console.error("Error fetching merchants:",l)}finally{S.value=!1}}),ee=()=>E(this,null,function*(){try{const l=yield z("iswitch.admin_portal_api.get_processors"),e=(l==null?void 0:l.message)||l;e&&e.processors&&(c.value=e.processors)}catch(l){console.error("Error fetching integrations:",l)}}),te=()=>E(this,null,function*(){try{const l=yield z("iswitch.admin_portal_api.get_services"),e=(l==null?void 0:l.message)||l;e&&e.services&&(w.value=e.services)}catch(l){console.error("Error fetching products:",l)}}),ae=l=>{console.log("Edit clicked for:",l);try{o.value=JSON.parse(JSON.stringify(l)),o.value.product_pricing||(o.value.product_pricing=[]),h.value="",b.value=!0,console.log("Dialog should be open, showEditDialog:",b.value)}catch(e){console.error("Error in editMerchant:",e),alert("Error opening edit dialog: "+e.message)}},oe=()=>{P.value="update_status",V.value="Approved",D.value=!0},se=()=>{P.value="update_integration",V.value="",D.value=!0},le=()=>E(this,null,function*(){if(V.value){v.value=!0;try{const l=B.value.map(e=>e.name);yield z("iswitch.admin_portal_api.bulk_update_merchants",{merchants:JSON.stringify(l),action:P.value,value:V.value}),D.value=!1,B.value=[],yield j()}catch(l){console.error("Error performing bulk update:",l)}finally{v.value=!1}}}),ne=()=>{o.value.product_pricing||(o.value.product_pricing=[]),o.value.product_pricing.push({product:"",fee_type:"Percentage",fee:0,tax_fee_type:"Percentage",tax_fee:18,start_value:0,end_value:0}),h.value=""},re=l=>{o.value.product_pricing.splice(l,1),h.value=""},de=()=>{h.value="";const l=o.value.product_pricing||[],e={};for(const a of l)a.product&&(e[a.product]||(e[a.product]=[]),e[a.product].push({start:parseFloat(a.start_value)||0,end:parseFloat(a.end_value)||0}));for(const a in e){const n=e[a].sort((U,i)=>U.start-i.start);for(let U=0;U<n.length-1;U++){const i=n[U],O=n[U+1];if(i.end>=O.start)return h.value=`Overlapping ranges detected for product '${a}': ${i.start}-${i.end} overlaps with ${O.start}-${O.end}`,!1}}return!0},ie=()=>E(this,null,function*(){if(o.value&&de()){v.value=!0;try{yield z("iswitch.admin_portal_api.update_merchant",{merchant:o.value.name,status:o.value.status,integration:o.value.integration,webhook:o.value.webhook,pricing:JSON.stringify(o.value.product_pricing||[])}),b.value=!1,yield j()}catch(l){console.error("Error updating merchant:",l)}finally{v.value=!1}}});return ve(()=>{j(),ee(),te()}),(l,e)=>(f(),g("div",Ve,[e[37]||(e[37]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h2",{class:"text-3xl font-bold tracking-tight"},"Merchants"),t("p",{class:"text-muted-foreground mt-2"},"Manage merchants and their pricing configurations.")])],-1)),t("div",Ce,[B.value.length>0?(f(),g("div",$e,[t("span",Be,k(B.value.length)+" selected",1),t("div",De,[d(s(C),{variant:"outline",size:"sm",onClick:oe},{default:r(()=>[...e[10]||(e[10]=[x(" Bulk Update Status ",-1)])]),_:1}),d(s(C),{variant:"outline",size:"sm",onClick:se},{default:r(()=>[...e[11]||(e[11]=[x(" Update Integration ",-1)])]),_:1})])])):F("",!0),d(be,{columns:m,data:u.value,"per-page":20,selectable:!0,"onUpdate:selection":e[0]||(e[0]=a=>B.value=a)},{"cell-status":r(({value:a})=>[t("span",{class:L(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",{"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":a==="Approved","bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":a==="Submitted","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":a==="Rejected"||a==="Terminated","bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300":a==="Draft"}])},k(a),3)]),"cell-wallet_balance":r(({value:a})=>[x(" â‚¹ "+k(a),1)]),"cell-actions":r(({row:a})=>[d(s(C),{variant:"outline",size:"sm",onClick:n=>ae(a)},{default:r(()=>[...e[12]||(e[12]=[x(" Edit ",-1)])]),_:1},8,["onClick"])]),_:1},8,["data"])]),d(s(W),{open:D.value,"onUpdate:open":e[4]||(e[4]=a=>D.value=a)},{default:r(()=>[d(s(q),{class:"sm:max-w-[500px]"},{default:r(()=>[d(s(K),null,{default:r(()=>[d(s(G),null,{default:r(()=>[x("Bulk Update "+k(P.value==="update_status"?"Status":"Integration"),1)]),_:1}),d(s(Q),null,{default:r(()=>[x(" Update "+k(B.value.length)+" selected merchants. ",1)]),_:1})]),_:1}),t("div",Pe,[P.value==="update_status"?(f(),g("div",Ee,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium mb-2"},"New Status",-1)),y(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>V.value=a),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...e[13]||(e[13]=[t("option",{value:"Draft"},"Draft",-1),t("option",{value:"Submitted"},"Submitted",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1),t("option",{value:"Terminated"},"Terminated",-1)])],512),[[$,V.value]])])):P.value==="update_integration"?(f(),g("div",Me,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium mb-2"},"New Integration",-1)),y(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>V.value=a),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[15]||(e[15]=t("option",{value:""},"Select Integration",-1)),(f(!0),g(T,null,N(c.value,a=>(f(),g("option",{key:a.name,value:a.name},k(a.integration_name),9,Fe))),128))],512),[[$,V.value]])])):F("",!0)]),d(s(Y),null,{default:r(()=>[d(s(C),{variant:"outline",onClick:e[3]||(e[3]=a=>D.value=!1),disabled:v.value},{default:r(()=>[...e[17]||(e[17]=[x("Cancel",-1)])]),_:1},8,["disabled"]),d(s(C),{onClick:le,loading:v.value},{default:r(()=>[...e[18]||(e[18]=[x("Update All",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["open"]),d(s(W),{open:b.value,"onUpdate:open":e[9]||(e[9]=a=>b.value=a)},{default:r(()=>[d(s(q),{class:"sm:max-w-[900px] z-[9999]"},{default:r(()=>{var a;return[d(s(K),null,{default:r(()=>[d(s(G),null,{default:r(()=>[...e[19]||(e[19]=[x("Edit Merchant",-1)])]),_:1}),d(s(Q),null,{default:r(()=>{var n;return[e[20]||(e[20]=x(" Update configuration for ",-1)),t("span",ze,k((n=o.value)==null?void 0:n.company_name),1)]}),_:1})]),_:1}),o.value?(f(),g("div",Ae,[t("div",Ie,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium mb-1"},"Status",-1)),y(t("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>o.value.status=n),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[...e[21]||(e[21]=[t("option",{value:"Draft"},"Draft",-1),t("option",{value:"Submitted"},"Submitted",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1),t("option",{value:"Terminated"},"Terminated",-1)])],512),[[$,o.value.status]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium mb-1"},"Integration",-1)),y(t("select",{"onUpdate:modelValue":e[6]||(e[6]=n=>o.value.integration=n),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[e[23]||(e[23]=t("option",{value:""},"Select Integration",-1)),(f(!0),g(T,null,N(c.value,n=>(f(),g("option",{key:n.name,value:n.name},k(n.integration_name),9,Te))),128))],512),[[$,o.value.integration]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium mb-1"},"Webhook URL",-1)),y(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=n=>o.value.webhook=n),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},null,512),[[A,o.value.webhook]])])]),t("div",null,[e[34]||(e[34]=t("h4",{class:"text-sm font-medium mb-2"},"Product Pricing configuration",-1)),t("div",Ne,[t("table",Re,[e[32]||(e[32]=t("thead",{class:"[&_tr]:border-b sticky top-0 bg-background z-10"},[t("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[t("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground w-[150px]"},"Product"),t("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground w-[120px]"},"Fee Type"),t("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground w-[100px]"},"Fee"),t("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground w-[120px]"},"Tax Type"),t("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground w-[100px]"},"Tax Fee"),t("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},"Range (Start - End)"),t("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground w-[50px]"})])],-1)),t("tbody",je,[(f(!0),g(T,null,N(o.value.product_pricing||[],(n,U)=>(f(),g("tr",{key:U,class:"border-b transition-colors hover:bg-muted/50"},[t("td",Oe,[y(t("select",{"onUpdate:modelValue":i=>n.product=i,class:"h-8 w-full rounded border border-input bg-transparent px-2 text-xs"},[e[26]||(e[26]=t("option",{value:"",disabled:""},"Select Product",-1)),(f(!0),g(T,null,N(w.value,i=>(f(),g("option",{key:i.name,value:i.name},k(i.product_name),9,Le))),128))],8,Je),[[$,n.product]])]),t("td",Xe,[y(t("select",{"onUpdate:modelValue":i=>n.fee_type=i,class:"h-8 w-full rounded border border-input bg-transparent px-2 text-xs"},[...e[27]||(e[27]=[t("option",{value:"Fixed"},"Fixed",-1),t("option",{value:"Percentage"},"Percentage",-1)])],8,He),[[$,n.fee_type]])]),t("td",We,[y(t("input",{type:"number",step:"0.01","onUpdate:modelValue":i=>n.fee=i,class:"h-8 w-full rounded border border-input bg-transparent px-2 text-xs"},null,8,qe),[[A,n.fee]])]),t("td",Ke,[y(t("select",{"onUpdate:modelValue":i=>n.tax_fee_type=i,class:"h-8 w-full rounded border border-input bg-transparent px-2 text-xs"},[...e[28]||(e[28]=[t("option",{value:"Fixed"},"Fixed",-1),t("option",{value:"Percentage"},"Percentage",-1)])],8,Ge),[[$,n.tax_fee_type]])]),t("td",Qe,[y(t("input",{type:"number",step:"0.01","onUpdate:modelValue":i=>n.tax_fee=i,class:"h-8 w-full rounded border border-input bg-transparent px-2 text-xs"},null,8,Ye),[[A,n.tax_fee]])]),t("td",Ze,[t("div",et,[y(t("input",{type:"number","onUpdate:modelValue":i=>n.start_value=i,class:"h-8 w-20 rounded border border-input bg-transparent px-2 text-xs",placeholder:"Start"},null,8,tt),[[A,n.start_value]]),e[29]||(e[29]=t("span",null,"-",-1)),y(t("input",{type:"number","onUpdate:modelValue":i=>n.end_value=i,class:"h-8 w-20 rounded border border-input bg-transparent px-2 text-xs",placeholder:"End"},null,8,at),[[A,n.end_value]])])]),t("td",ot,[t("button",{onClick:i=>re(U),class:"text-destructive hover:text-destructive/80"},[...e[30]||(e[30]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M3 6h18"}),t("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),t("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1)])],8,st)])]))),128)),(a=o.value.product_pricing)!=null&&a.length?F("",!0):(f(),g("tr",lt,[...e[31]||(e[31]=[t("td",{colspan:"7",class:"p-4 align-middle text-center text-muted-foreground"},"No pricing configured.",-1)])]))])])]),t("div",nt,[d(s(C),{variant:"outline",size:"sm",onClick:ne},{default:r(()=>[...e[33]||(e[33]=[x("Add Pricing",-1)])]),_:1})])])])):F("",!0),h.value?(f(),g("div",rt,[t("div",dt,k(h.value),1)])):F("",!0),d(s(Y),{class:"mt-4"},{default:r(()=>[d(s(C),{variant:"outline",onClick:e[8]||(e[8]=n=>b.value=!1),disabled:v.value},{default:r(()=>[...e[35]||(e[35]=[x("Cancel",-1)])]),_:1},8,["disabled"]),d(s(C),{onClick:ie,loading:v.value},{default:r(()=>[...e[36]||(e[36]=[x("Save Changes",-1)])]),_:1},8,["loading"])]),_:1})]}),_:1})]),_:1},8,["open"])]))}};export{ft as default};
//# sourceMappingURL=Merchants-BVss99vI.js.map
