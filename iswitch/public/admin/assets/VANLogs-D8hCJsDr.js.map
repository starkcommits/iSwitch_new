{"version":3,"file":"VANLogs-D8hCJsDr.js","sources":["../../../../admin/src/pages/VANLogs.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6\">\n    <div class=\"flex items-center justify-between\">\n      <div>\n        <h1 class=\"text-3xl font-bold tracking-tight text-foreground\">VAN Logs</h1>\n        <p class=\"text-muted-foreground mt-1\">Monitor Virtual Account Number (VAN) activity and logs.</p>\n      </div>\n      <div class=\"flex items-center gap-2\">\n        <button class=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2\" @click=\"exportVANLogs\">\n          <svg class=\"mr-2 h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n            <polyline points=\"7 10 12 15 17 10\" />\n            <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n          </svg>\n          Export\n        </button>\n      </div>\n    </div>\n\n    <!-- Filters -->\n    <div class=\"rounded-xl border bg-card text-card-foreground shadow-sm p-6 mb-6\">\n      <h3 class=\"text-lg font-semibold mb-4\">Filters</h3>\n      <div class=\"flex flex-wrap items-end gap-4\">\n        <div class=\"flex-1 min-w-[200px]\">\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">STATUS</label>\n          <select v-model=\"filters.status\" class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\">\n            <option value=\"\">All Status</option>\n            <option value=\"Success\">Success</option>\n            <option value=\"Pending\">Pending</option>\n            <option value=\"Failed\">Failed</option>\n          </select>\n        </div>\n\n        <div class=\"flex-1 min-w-[200px]\">\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">FROM DATE & TIME</label>\n          <input \n            type=\"datetime-local\" \n            v-model=\"filters.fromDate\" \n            class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n          />\n        </div>\n\n        <div class=\"flex-1 min-w-[200px]\">\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">TO DATE & TIME</label>\n          <input \n            type=\"datetime-local\" \n            v-model=\"filters.toDate\" \n            class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n          />\n        </div>\n\n        <button \n          class=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6\"\n          @click=\"applyFilters\"\n        >\n          Apply Filters\n        </button>\n      </div>\n    </div>\n\n    <!-- Table -->\n    <div class=\"rounded-xl border bg-card text-card-foreground shadow-sm overflow-hidden\">\n      <DataTable\n        :columns=\"vanColumns\"\n        :data=\"vanLogs\"\n        :per-page=\"10\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport DataTable from '@/components/DataTable.vue'\nimport { call } from 'frappe-ui'\n\n// Filters\nconst filters = ref({\n  status: '',\n  fromDate: '',\n  toDate: ''\n})\n\nconst vanColumns = [\n  { key: 'id', label: 'Transaction ID', sortable: true },\n  { key: 'merchant', label: 'Merchant', sortable: true },\n  { key: 'account_number', label: 'Account Number', sortable: true },\n  { key: 'amount', label: 'Amount', type: 'currency', sortable: true },\n  { key: 'type', label: 'Type', sortable: true },\n  { key: 'utr', label: 'UTR', sortable: true },\n  { key: 'status', label: 'Status', type: 'badge', sortable: true },\n  { key: 'date', label: 'Date', type: 'datetime', sortable: true }\n]\n\nconst vanLogs = ref([])\nconst loading = ref(false)\n\n// Fetch VAN logs from API\nconst fetchVANLogs = async () => {\n  loading.value = true\n  try {\n    const filterData = {\n      status: filters.value.status || null,\n      from_date: filters.value.fromDate || null,\n      to_date: filters.value.toDate || null\n    }\n\n    const response = await call('iswitch.admin_portal_api.get_van_logs', {\n      filter_data: JSON.stringify(filterData),\n      page: 1,\n      page_size: 50\n    })\n    \n    // Frappe wraps response in 'message' object\n    const data = response?.message || response\n    \n    if (data && data.logs) {\n      vanLogs.value = data.logs.map(log => ({\n        id: log.id,\n        merchant: log.merchant_name || 'N/A',\n        account_number: log.account_number,\n        amount: parseFloat(log.amount || 0),\n        type: log.type,\n        utr: log.utr || '-',\n        status: log.status.toLowerCase(),\n        opening_balance: parseFloat(log.opening_balance || 0),\n        closing_balance: parseFloat(log.closing_balance || 0),\n        remitter_name: log.remitter_name,\n        remitter_account_number: log.remitter_account_number,\n        remitter_ifsc_code: log.remitter_ifsc_code,\n        date: log.date\n      }))\n    }\n  } catch (error) {\n    console.error('Error fetching VAN logs:', error)\n    vanLogs.value = []\n  } finally {\n    loading.value = false\n  }\n}\n\nconst applyFilters = () => {\n  fetchVANLogs()\n}\n\nconst exportVANLogs = async () => {\n  try {\n    const filterData = {\n      status: filters.value.status || null,\n      from_date: filters.value.fromDate || null,\n      to_date: filters.value.toDate || null\n    }\n    \n    const queryParams = new URLSearchParams({\n      filters: JSON.stringify(filterData)\n    }).toString()\n    \n    window.location.href = `/api/method/iswitch.admin_portal_api.export_van_logs_to_excel?${queryParams}`\n  } catch (error) {\n    console.error('Error exporting VAN logs:', error)\n  }\n}\n\n// Fetch VAN logs when component mounts\nonMounted(() => {\n  fetchVANLogs()\n})\n</script>\n\n<style scoped>\n.space-y-6 > * + * {\n  margin-top: 1.5rem;\n}\n</style>\n"],"names":["filters","ref","vanColumns","vanLogs","loading","fetchVANLogs","__async","filterData","response","call","data","log","error","applyFilters","exportVANLogs","queryParams","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","_hoisted_3","_hoisted_4","$event","_vModelSelect","_hoisted_5","_vModelText","_hoisted_6","_hoisted_7","_createVNode","DataTable"],"mappings":"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"}