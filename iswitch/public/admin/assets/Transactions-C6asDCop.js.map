{"version":3,"file":"Transactions-C6asDCop.js","sources":["../../../../admin/src/pages/Transactions.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6\">\n    <div class=\"flex items-center justify-between\">\n      <div>\n        <h1 class=\"text-3xl font-bold tracking-tight text-foreground\">Transactions</h1>\n        <p class=\"text-muted-foreground mt-1\">View and manage all financial transactions.</p>\n      </div>\n      <button class=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2\" @click=\"exportLedger\">\n        <svg class=\"mr-2 h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n          <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n          <polyline points=\"7 10 12 15 17 10\" />\n          <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n        </svg>\n        Export\n      </button>\n    </div>\n\n    <!-- Filters -->\n    <div class=\"rounded-xl border bg-card text-card-foreground shadow-sm p-6 mb-6\">\n      <h3 class=\"text-lg font-semibold mb-4\">Filters</h3>\n      <div class=\"flex flex-wrap items-end gap-4\">\n        <div class=\"flex-1 min-w-[200px]\">\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">STATUS</label>\n          <select v-model=\"filters.status\" class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\">\n            <option value=\"\">All Status</option>\n            <option value=\"Success\">Success</option>\n            <option value=\"Pending\">Pending</option>\n            <option value=\"Processing\">Processing</option>\n            <option value=\"Failed\">Failed</option>\n            <option value=\"Reversed\">Reversed</option>\n          </select>\n        </div>\n\n        <div class=\"flex-1 min-w-[200px]\">\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">FROM DATE & TIME</label>\n          <input \n            type=\"datetime-local\" \n            v-model=\"filters.fromDate\" \n            class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n          />\n        </div>\n\n        <div class=\"flex-1 min-w-[200px]\">\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">TO DATE & TIME</label>\n          <input \n            type=\"datetime-local\" \n            v-model=\"filters.toDate\" \n            class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n          />\n        </div>\n\n        <button \n          class=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6\"\n          @click=\"applyFilters\"\n        >\n          Apply Filters\n        </button>\n      </div>\n    </div>\n\n    <!-- Table -->\n    <div class=\"rounded-xl border bg-card text-card-foreground shadow-sm overflow-hidden\">\n      <DataTable\n        :columns=\"transactionColumns\"\n        :data=\"transactionData\"\n        :per-page=\"10\"\n      >\n        <template #cell-status=\"{ value }\">\n          <span \n            class=\"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\"\n            :class=\"{\n              'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300': value === 'success',\n              'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300': value === 'processing' || value === 'pending',\n              'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300': value === 'failed' || value === 'reversed'\n            }\"\n          >\n            {{ value.charAt(0).toUpperCase() + value.slice(1) }}\n          </span>\n        </template>\n      </DataTable>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport DataTable from '@/components/DataTable.vue'\nimport { call } from 'frappe-ui'\n\n// Filters\nconst filters = ref({\n  status: '',\n  fromDate: '',\n  toDate: ''\n})\n\nconst transactionColumns = [\n  { key: 'id', label: 'Transaction ID', sortable: true },\n  { key: 'merchant', label: 'Merchant', sortable: true },\n  { key: 'order_id', label: 'Order ID', sortable: true },\n  { key: 'product_name', label: 'Product', sortable: true },\n  { key: 'amount', label: 'Amount', type: 'currency', sortable: true },\n  { key: 'status', label: 'Status', type: 'badge', sortable: true },\n  { key: 'integration', label: 'Integration', sortable: true },\n  { key: 'utr', label: 'UTR', sortable: true },\n  { key: 'date', label: 'Date', type: 'datetime', sortable: true }\n]\n\nconst transactionData = ref([])\nconst loading = ref(false)\n\n// Fetch transactions from API\nconst fetchTransactions = async () => {\n  loading.value = true\n  try {\n    const filterData = {\n      status: filters.value.status || null,\n      from_date: filters.value.fromDate || null,\n      to_date: filters.value.toDate || null\n    }\n\n    const response = await call('iswitch.admin_portal_api.get_transactions', {\n      filter_data: JSON.stringify(filterData),\n      page: 1,\n      page_size: 50\n    })\n    \n    // Frappe wraps response in 'message' object\n    const data = response?.message || response\n    \n    if (data && data.transactions) {\n      transactionData.value = data.transactions.map(entry => ({\n        id: entry.id,\n        merchant: entry.merchant_name || 'N/A',\n        order_id: entry.order_id || '-',\n        product_name: entry.product_name || '-',\n        amount: parseFloat(entry.amount || 0),\n        status: entry.status.toLowerCase(),\n        integration: entry.integration || '-',\n        utr: entry.utr || '-',\n        date: entry.date\n      }))\n    }\n  } catch (error) {\n    console.error('Error fetching transactions:', error)\n    transactionData.value = []\n  } finally {\n    loading.value = false\n  }\n}\n\nconst applyFilters = () => {\n  fetchTransactions()\n}\n\n// Fetch transactions when component mounts\nonMounted(() => {\n  fetchTransactions()\n})\n\nconst viewEntry = (entry) => {\n  console.log('Viewing entry:', entry)\n}\n</script>\n\n<style scoped>\n.space-y-6 > * + * {\n  margin-top: 1.5rem;\n}\n</style>\n"],"names":["filters","ref","transactionColumns","transactionData","loading","fetchTransactions","__async","filterData","response","call","data","entry","error","applyFilters","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_ctx","args","_hoisted_3","_cache","_hoisted_4","_hoisted_5","$event","_vModelSelect","_hoisted_6","_vModelText","_hoisted_7","_hoisted_8","_createVNode","DataTable","_withCtx","value","_toDisplayString"],"mappings":"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"}