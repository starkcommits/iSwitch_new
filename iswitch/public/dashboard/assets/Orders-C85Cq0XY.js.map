{"version":3,"file":"Orders-C85Cq0XY.js","sources":["../../../../Merchant/src/pages/Orders.vue"],"sourcesContent":["<template>\n  <div class=\"orders-page\">\n    <div class=\"flex items-center justify-between mb-8\">\n      <div>\n        <h1 class=\"text-3xl font-bold tracking-tight text-foreground\">Orders</h1>\n        <p class=\"text-muted-foreground mt-1\">View and track all your transaction orders.</p>\n      </div>\n      <button \n        class=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2\" \n        @click=\"exportOrders\"\n      >\n        <svg class=\"mr-2 h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n          <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n          <polyline points=\"7 10 12 15 17 10\" />\n          <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n        </svg>\n        Export\n      </button>\n    </div>\n\n    <!-- Filters -->\n    <div class=\"rounded-xl border bg-card text-card-foreground shadow-sm p-4 md:p-6 mb-6\">\n      <h3 class=\"text-lg font-semibold mb-4\">Filters</h3>\n      <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end\">\n        <div>\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">STATUS</label>\n          <select v-model=\"filters.status\" class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\">\n            <option value=\"All Status\">All Status</option>\n            <option value=\"Queued\">Queued</option>\n            <option value=\"Processing\">Processing</option>\n            <option value=\"Processed\">Processed</option>\n            <option value=\"Cancelled\">Cancelled</option>\n            <option value=\"Reversed\">Reversed</option>\n          </select>\n        </div>\n\n        <div>\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">FROM DATE & TIME</label>\n          <input \n            type=\"datetime-local\" \n            v-model=\"filters.fromDate\" \n            class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n          />\n        </div>\n\n        <div>\n          <label class=\"block text-sm font-medium text-muted-foreground mb-2\">TO DATE & TIME</label>\n          <input \n            type=\"datetime-local\" \n            v-model=\"filters.toDate\" \n            class=\"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n          />\n        </div>\n\n        <button \n          class=\"w-full inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6\"\n          @click=\"applyFilters\"\n        >\n          Apply Filters\n        </button>\n      </div>\n    </div>\n\n    <!-- Data Table -->\n    <DataTable\n      :columns=\"orderColumns\"\n      :data=\"orders\"\n      :per-page=\"10\"\n    >\n      <template #cell-customer=\"{ value }\">\n        <div class=\"customer-cell\">\n          <div class=\"customer-avatar\">{{ value.charAt(0) }}</div>\n          <span>{{ value }}</span>\n        </div>\n      </template>\n    </DataTable>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport DataTable from '@/components/DataTable.vue'\nimport { call } from 'frappe-ui'\n\n// Filters\nconst filters = ref({\n  status: 'All Status',\n  fromDate: '',\n  toDate: ''\n})\n\n// Order columns\nconst orderColumns = [\n  { key: 'id', label: 'ORDER ID', sortable: true },\n  { key: 'customer', label: 'CUSTOMER', sortable: true },\n  { key: 'amount', label: 'AMOUNT', type: 'currency', sortable: true },\n  { key: 'fee', label: 'FEE', type: 'currency', sortable: true },\n  { key: 'status', label: 'STATUS', type: 'badge', sortable: true },\n  { key: 'utr', label: 'UTR', sortable: true },\n  { key: 'date', label: 'DATE', type: 'datetime', sortable: true }\n]\n\n// Order data and pagination\nconst orders = ref([])\nconst totalOrders = ref(0)\nconst currentPage = ref(1)\nconst pageSize = ref(20)\nconst loading = ref(false)\n\n// Fetch orders from API\nconst fetchOrders = async () => {\n  loading.value = true\n  try {\n    const filterData = {\n      status: filters.value.status !== 'All Status' ? filters.value.status : null,\n      from_date: filters.value.fromDate || null,\n      to_date: filters.value.toDate || null\n    }\n    \n    const response = await call('iswitch.merchant_portal_api.get_orders', {\n      filter_data: JSON.stringify(filterData),\n      page: currentPage.value,\n      page_size: pageSize.value,\n      sort_by: 'creation',\n      sort_order: 'desc'\n    })\n    \n    // Frappe wraps response in 'message' object\n    const data = response?.message || response\n    \n    if (data && data.orders) {\n      orders.value = data.orders.map(order => ({\n        id: order.id,\n        customer: order.customer || 'N/A',\n        amount: parseFloat(order.amount || 0),\n        fee: parseFloat(order.fee || 0),\n        status: order.status,\n        utr: order.utr || '-',\n        date: order.date\n      }))\n      totalOrders.value = data.total || 0\n    }\n  } catch (error) {\n    console.error('Error fetching orders:', error)\n    orders.value = []\n    totalOrders.value = 0\n  } finally {\n    loading.value = false\n  }\n}\n\n// Filtered orders (API already handles filtering, this is for client-side refinement only)\nconst filteredOrders = computed(() => {\n  let filtered = [...orders.value]\n  \n  // Only apply client-side filters if they are explicitly set\n  // API handles the main filtering, this is just for additional refinement\n  if (filters.value.status && filters.value.status !== 'All Status' && filters.value.status !== '') {\n    filtered = filtered.filter(t => t.status.toLowerCase() === filters.value.status.toLowerCase())\n  }\n  \n  if (filters.value.fromDate) {\n    const fromDate = new Date(filters.value.fromDate)\n    filtered = filtered.filter(t => new Date(t.date) >= fromDate)\n  }\n  \n  if (filters.value.toDate) {\n    const toDate = new Date(filters.value.toDate)\n    filtered = filtered.filter(t => new Date(t.date) <= toDate)\n  }\n  \n  return filtered\n})\n\nconst applyFilters = () => {\n  currentPage.value = 1 // Reset to first page when filtering\n  fetchOrders()\n}\n\nconst exportOrders = () => {\n  try {\n    const filterData = {\n      status: filters.value.status !== 'All Status' ? filters.value.status : null,\n      from_date: filters.value.fromDate || null,\n      to_date: filters.value.toDate || null\n    }\n    \n    const queryParams = new URLSearchParams({\n      filters: JSON.stringify(filterData)\n    }).toString()\n    \n    window.location.href = `/api/method/iswitch.merchant_portal_api.export_orders_to_excel?${queryParams}`\n  } catch (error) {\n    console.error('Error exporting orders:', error)\n  }\n}\n\nconst viewOrder = (order) => {\n  console.log('View order:', order)\n}\n\n// Fetch orders when component mounts\nonMounted(() => {\n  fetchOrders()\n})\n</script>\n\n<style scoped>\n.orders-page {\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 2rem;\n}\n\n.page-title {\n  font-size: 2rem;\n  font-weight: 700;\n  color: var(--color-text-primary);\n}\n\n.filters-section {\n  padding: 1.5rem;\n  display: flex;\n  align-items: flex-end;\n  gap: 1.5rem;\n  flex-wrap: wrap;\n  margin-bottom: 1.5rem;\n}\n\n.filter-group {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  flex: 1;\n  min-width: 200px;\n}\n\n.filter-label {\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n\n.filter-select,\n.filter-input {\n  width: 100%;\n  background: var(--color-bg-tertiary);\n  border: 1px solid var(--color-border);\n  border-radius: var(--radius-md);\n  padding: 0.625rem 1rem;\n  color: var(--color-text-primary);\n  font-size: 0.875rem;\n  transition: all 0.2s ease;\n}\n\n.filter-select:focus,\n.filter-input:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);\n}\n\n.customer-cell {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.customer-avatar {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 600;\n  font-size: 0.75rem;\n  color: white;\n  flex-shrink: 0;\n}\n\n.action-btn {\n  background: var(--color-bg-tertiary);\n  border: 1px solid var(--color-border);\n  border-radius: var(--radius-sm);\n  padding: 0.5rem;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.action-btn:hover {\n  background: var(--color-bg-hover);\n  color: var(--color-primary);\n  border-color: var(--color-primary);\n}\n\n@media (max-width: 768px) {\n  .page-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 1rem;\n  }\n  \n  .filters-section {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n  \n  .filter-group {\n    width: 100%;\n  }\n}\n</style>\n"],"names":["filters","ref","orderColumns","orders","totalOrders","currentPage","pageSize","loading","fetchOrders","__async","filterData","response","call","data","order","error","computed","filtered","t","fromDate","toDate","applyFilters","exportOrders","queryParams","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","_hoisted_3","$event","_vModelSelect","_vModelText","_createVNode","DataTable","_withCtx","value","_hoisted_4","_hoisted_5","_toDisplayString"],"mappings":"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"}